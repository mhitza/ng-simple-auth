(function(){var e;e=angular.module("SimpleAuth",["SimpleAuth.Constants","SimpleAuth.Session","SimpleAuth.AuthInterceptor","SimpleAuth.HasPerm"])}).call(this),function(){var e;e=angular.module("SimpleAuth.Constants",[]),e.constant("AUTH_EVENTS",{loginSuccess:"event:auth-loginConfirmed",loginFailed:"event:auth-loginCancelled",logoutSuccess:"event:auth-logoutSuccess",notAuthenticated:"event:auth-loginRequired",notAuthorized:"event:auth-credentialsInsufficient",userChange:"event:session-userChange"})}.call(this),function(){var e;e=angular.module("SimpleAuth.HasPerm",["SimpleAuth.Constants","SimpleAuth.Session"]),e.directive("saHasPerm",["$rootScope","saSession","AUTH_EVENTS",function(e,t,n){return{restrict:"A",link:function(r,i,u){var s,o,a,l;return o=u.saHasPerm.split(" "),a=angular.bind(i,i.css,"display",i.css("display")),s=angular.bind(i,i.css,"display","none"),l=function(){return t.hasRole(o)?a():s()},l(),e.$on(n.userChange,l)}}}])}.call(this),function(){var e,t,n;n=angular.module("SimpleAuth.HeaderService",[]),t={user:"x-authenticate-user",token:"x-access-token"},e=function(){function e(){this.headerService=function(e,n){var r;return r=t[n],r?e.headers(r):null}}return e.prototype.setKey=function(e,n){return t[e]=n,this},e.prototype.$get=function(){return this.headerService},e}(),n.provider("headerService",new e)}.call(this),function(){var e;e=angular.module("SimpleAuth.AuthInterceptor",["SimpleAuth.Session","SimpleAuth.HeaderService"]),e.factory("saAuthResponseInterceptor",["saSession","headerService",function(e,t){var n;return n=function(n){var r,i;return r=t(n,"token"),i=t(n,"user"),i&&e.setUser(i),r&&e.setToken(r),n},function(e){return e.then(n)}}]),e.config(["$httpProvider",function(e){return e.interceptors.push("saAuthResponseInterceptor")}])}.call(this),function(){var e;e=angular.module("SimpleAuth.Login",["SimpleAuth.Constants","SimpleAuth.Session","SimpleAuth.UrlService"]),e.factory("saLogin",["$http","$rootScope","saSession","urlService","AUTH_EVENTS",function(e,t,n,r,i){var u;return u={login:function(n){var u;return u=e.post(r("login"),n),u.success(function(e){return t.$broadcast(i.loginSuccess,e)})},logout:function(){var u;return u=e.post(r("logout"),{}),u.success(function(e){return function(r){return e.isAuthenticated()&&n.destroy(),t.$broadcast(i.logoutSuccess,r)}}(this)),u},isAuthenticated:function(){return n.isValid()},isAuthorized:function(e){return angular.isArray(e)||(e=[e]),this.isAuthenticated()&&n.hasRole(e)}}}])}.call(this),function(){var e;e=angular.module("SimpleAuth.Session",["SimpleAuth.Constants"]),e.factory("saSession",["$rootScope","AUTH_EVENTS",function(e,t){var n;return n={create:function(e,t){return this.destroy(),this.setToken(e),this.setUser(t),this},isValid:function(){return angular.isObject(this.user)&&angular.isString(this.token)},hasRole:function(e){var t,n,r;if(!this.isValid())return!1;for(angular.isArray(e)||(e=[e]),n=0,r=e.length;r>n;n++)if(t=e[n],-1!==this.roles.indexOf(t))return!0;return!1},destroy:function(){return this.token=null,this.user=e.user=null,this.roles=[],!0},setUser:function(n){return angular.isString(n)&&(n=angular.fromJson(n)),n?angular.equals(n,this.user)||(this.user=e.user=n,angular.isArray(n.roles)&&(this.roles=n.roles),e.$broadcast(t.userChange,this.user)):this.user=e.user=null,this},setToken:function(e){return angular.equals(e,this.token)||(this.token=e),this}}}])}.call(this),function(){var e,t,n;e=angular.module("SimpleAuth.UrlService",[]),n={login:"/login",logout:"/logout"},t=function(){function e(){this.urlService=function(e){return n[e]?n[e]:null}}return e.prototype.setUrl=function(e,t){return n[e]=t,this},e.prototype.$get=[function(){return this.urlService}],e}(),e.provider("urlService",new t)}.call(this);